\documentclass[fleqn,final]{beamer}
\mode<presentation>
{  \usetheme{I6dv} }
\usepackage{times}
\usepackage{etex}
\usepackage{amsmath,amssymb}
%\usepackage{sfmath} % for sans serif math fonts; wget http://dtrx.de/od/tex/sfmath.sty
\usepackage[english]{babel}
\usepackage[ansinew]{inputenc}
\usepackage[orientation=portrait,size=a0,scale=1.25,debug]{beamerposter}
\usepackage{booktabs,array}
\usepackage{listings}
%\usepackage{picins,graphicx}
\usepackage{xspace}
\usepackage{fp}
\usepackage{ifthen}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{tikz,colortbl,pgf,pgfarrows,pgfnodes,pgfautomata,pgfheaps,pgfshade,eurosym, dsfont}
\usepackage{tcolorbox}
\listfiles
\newcommand*{\signstream}{SignStream\texttrademark\xspace}
\newcommand{\WichtigFarbe}{\color{red}}%
\newcommand{\TextFarbe}{\color{black}}%
\newcommand{\Pheight}{\rule[-5mm]{0cm}{1cm}}

\definecolor{darkblue}{rgb}{0.28,0,0.60}
\definecolor{hblue}{rgb}{0.70,0.7,1}
\definecolor{NR0}{rgb}{1,1,1}
\definecolor{NR1}{rgb}{1,1,0.8}
\definecolor{NR2}{rgb}{1,1,0.5}
\definecolor{NR3}{rgb}{1,1,0.25}
\definecolor{NR4}{rgb}{1,1,0.0}
\definecolor{NR5}{rgb}{1,0.75,0.0}
\definecolor{NR6}{rgb}{1,0.5,0.0}
\definecolor{NR7}{rgb}{1,0.25,0.0}
\definecolor{NR8}{rgb}{1,0,0.0}

\setbeamertemplate{navigation symbols}{}
\setbeamerfont{title}{series=\bfseries}
%\setbeamercolor{frametitle}{fg=UTblue}
\setbeamerfont{frametitle}{series=\bfseries}
\setbeamertemplate{frametitle}
{
\begin{centering}
\insertframetitle\vspace*{-4mm}\par
\end{centering}
}

\newcommand{\convD}{\stackrel{\text{d}}{\longrightarrow}}
\newcommand{\E}{\text{E}\,}
\newcommand{\var}{\text{V}\,}

\title{\huge Performance of Empirical Best Predictor in Informative Samples - A Monte Carlo Simulation}
\author{\large Felix Skarke, Enno Tammena, Christian Koopmann}
\institute{Freie Universit{\"a}t Berlin, Humboldt Universit{\"a}t zu Berlin}

\date{today}
\begin{document}

\begin{frame}

%
%------------------------------------------------------ ------------------------------------------------------
%
\small
\begin{columns}[t] % Wechsel in die Spaltenumgebung

\begin{column}{.3\linewidth} 
\begin{block}{Idea of simulation study  \Pheight}
\begin{itemize}
\item Dealing with domains of interest, that do not have a sufficiently large sample size can lead to unsatisfactory results, when using direct estimators \\
$\Rightarrow$ reasoning behind using small area methods like EBP (Empirical Best Predictor) approach \\
\vskip .5cm
\item When complex sampling designs are used to generate a sample (practical reasons, special interest in small subpopulation), not using sampling weights can lead to biased estimators \\
$\Rightarrow$ use of direct estimators like weighted Gini\\
$\Rightarrow$ In model-based inference normally the sampling design is assumed to be uninformative (like SRS):\\ $P(s|y)=P(s),\;\; \forall y\in \mathbb{R}^N,\; \forall s$
\vskip .5cm
\item Since sampling weights cannot be used directly in the EBP approach the question of this study is how to deal with a sample that has a complex sampling design and also might not have enough subjects in every domain of interest for a direct estimator to deliver good results
\end{itemize}

\end{block}
\end{column}

%
%------------------------------------------------------ ------------------------------------------------------
%

\begin{column}{.3\linewidth}
\begin{block}{The Gini: a meassure for inequality\Pheight}
\begin{minipage}{0.5\textwidth}
\begin{figure}[ht]
\includegraphics[scale=1.5]{Lorenz.pdf}
\end{figure}
\end{minipage}%
\begin{minipage}{.5\textwidth}
\begin{itemize}
\item The Gini coefficient is used to meassure inequality of distribution (e.g. income, wealth) in a society
\item It is defined as the area between the Lorenz curve and the 45° line (=A) in relation to the area beneath the 45° line (=A+B), where B is the area under the Lorenz curve  
\end{itemize}
\end{minipage}%
\end{block}
\vskip .5cm
\centering
\begin{tcolorbox}
Therefore it can be expressed as:
\begin{equation*}
G=A/(A+B)=2A=1-2B
\end{equation*}
\end{tcolorbox}
\end{column}

%
%------------------------------------------------------ ------------------------------------------------------
%

\begin{column}{.3\linewidth}
 \begin{block}{The Gini: unweighted and weighted \Pheight}
The Gini coefficient can be expressed without a direct reference to the Lorenz curve:\\
\vskip 0.5cm
\textbf{unweighted version}
\begin{tcolorbox}
\begin{equation*}
\hat{G}={\frac {2\sum_{i=1}^{n}\;iy_{i}}{n\sum _{i=1}^{n}y_{i}}}-{\frac {n+1}{n}}
\end{equation*}
\end{tcolorbox}
\vskip 0.5cm
\textbf{weighted version}
\begin{tcolorbox}
\begin{equation*}
\hat{G}=100\Bigg[{\frac {2\sum_{i=1}^{n}\;(w_{i}y_{i}\sum_{j=1}^{i}\;w_{j})-\sum_{i=1}^{n}\;w_{i}^{2}y_{i}}{(\sum_{i=1}^{n}\;w_{i})\sum_{i=1}^{n}\;(w_{i}y_{i})}-1}\Bigg]
\end{equation*}
\end{tcolorbox}
\vskip 0.5cm
{\fontencoding{U}\fontfamily{futs}\selectfont\char 66\relax} Using weights in direct estimators is important, if a complex sampling design is used. Not weighting the observations leads to (sometimes severely) biased estimates.
\end{block}
\end{column}

%
%------------------------------------------------------ ------------------------------------------------------
%

\end{columns}


\begin{columns}[t]


%
%------------------------------------------------------ ------------------------------------------------------
%


  
\begin{column}{.3\linewidth}
\begin{block}{Empirical Best Predictor \Pheight}
\underline{random effects model}:\\
\vskip 1.5cm
\scalebox{1.2}{$y_{ij}=x_{ij}\prime\beta+u_{i}+e_{ij},\;\;\;j=1,\dots,n_{i},\;\;i=1,\dots,D$} \\
\vskip 1.0cm
,where $u_{i}\sim\mathcal{N}(0,\sigma_{u}^2)$ and $e_{ij}\sim\mathcal{N}(0,\sigma_{e}^2)$ \\
\vskip 2cm
\textbf{estimation of model}:
\vskip .5cm
\begin{enumerate}
\item estimate $\hat{\beta},\hat{\sigma}_{u}^2,\hat{\sigma}_{e}^2,\hat{u}_{i},\hat{\gamma}_{i}=\frac{\hat{\sigma}_{u}^2}{\hat{\sigma}_{u}^2+\frac{\hat{\sigma}_{e}^2}{n_{i}}}$ from sample
\item generate $e_{ij}^*\sim\mathcal{N}(0,\hat{\sigma}_{e}^2)$ and $u_{i}^*\sim\mathcal{N}(0,\hat{\sigma}_{u}^2(1-\hat{\gamma}_{i}))$ for L pseudo-populations: \[y_{ij}^{*(l)}=x_{ij}\prime\hat{\beta}+\hat{u}_{i}+u_{i}^*+e_{ij}^*\]\\
$\Rightarrow$ obtain an estimator of interest in each domain for every pseudo-population
\item calculate $\hat{\theta}_{i}^{EBP}=\frac{1}{L}\sum_{l=1}^{L}\hat{\theta}_{i}^{(l)}$ for each domain
\end{enumerate}

\end{block}
\end{column}
%
%------------------------------------------------------ ------------------------------------------------------
% Folie 5
   
\begin{column}{.3\linewidth}

\begin{block}{MSE estimation \Pheight}
Since analytical approximations of the MSE are difficult to derive in the case of nonlinear indicators as the FGT or the Gini the MSE will be approximated using a bootstrap procedure:
\begin{enumerate}
\item Fit the model to the sample data and therefore obtain estimates for $\beta, \sigma_{u}^2 and \sigma_{e}^2$
\item Generate $u_{i}^*\sim iid \mathcal{N}(0,\hat{\sigma}_{u}^2)$ and $e_{ij}^*\sim iid \mathcal{N}(0,\hat{\sigma}_{e}^2)$ independently for every domain and every person in the population
\item Construct a superpopulation using the generated error terms and the population covariates
\[y_{ij}^*=x_{ij}\prime\hat{\beta}+u_{i}^*+e_{ij}^*\]
\item Draw B bootstrap populations from the superpopulation and calculate $\theta_{i}^{*b}$ in every domain for each of the populations
\item Draw a bootstrap sample from every population, implement the EBP and estimate $\hat{\theta}_{i}^{*b}$
\item Finally estimate the MSE per domain by: 
\[\hat{MSE}=\frac{1}{B}\sum_{b=1}^B (\hat{\theta}_{i}^{*b}-\theta_{i}^{*b})^2\]
\end{enumerate}
\end{block}
\end{column}    



%
%------------------------------------------------------ ------------------------------------------------------
% Folie 6 

  % 


\begin{column}{.3\linewidth}


\begin{block}{Implementation \Pheight}
\begin{itemize}
\item Dataset: EUSILC Data as provided by the emdi package
\item to achieve a sufficient population size $N$, randomly dublicate observations between 1 and 8 times
\item add $\varepsilon$ to the dependent variable of duplicated observations
\item take a random sample of $g$ observations from 5 income groups to get a sample of size $n$
\item calculate $frequency weights = N_{SMA,income group}/n_{SMA}/5 $
\item take random sample of $c$ observations for second level EBP data 
 
\item for 1:s \{
\begin{enumerate}  % F�r Aufz�hlungen
\item split population by SMA, take a sample of $n_{sma} / 5$ from each income group
\item estimate $Gini_{direct}, Gini_{weighted}$
\item estimate $Gini_{EBP}$  based on $l$ pseudo-populations
\item estimate $MSE_{Gini_{EBP}}$ based on $b$ bootstraps
\item expand the sample by frequency weights
\item estimate $Gini_{weighted EBP}$  based on $l$ pseudo-populations
\item save the results per SMA
\end{enumerate}
\}
 
\item calculate quality measures per SMA 
 \end{itemize}
Parameters: $N=112644, s=250, \varepsilon \sim N(0,5000), g=2000, n=10000, c=25000, l=50, b=10, SMA=District$
\end{block}



 
\end{column}



%
%------------------------------------------------------ ------------------------------------------------------
%
  
\end{columns}  



\begin{columns}[t]

%
%------------------------------------------------------ ------------------------------------------------------
% 10 


\begin{column}{.3\linewidth}

\begin{block}{RMSE of weighted and unweighted EBP per Domain \Pheight}
\begin{center}
	\begin{figure}
		\includegraphics[width=0.9\textwidth]{EBPWeightedRMSE}
		\caption{RMSE of Weighted EBP per Domain}
	\end{figure}
		\begin{figure}
		\includegraphics[width=0.9\textwidth]{EBPUnweightedRMSE}
		\caption{RMSE of Unweighted EBP per Domain}
	\end{figure}
\end{center}

\end{block}

\end{column}

%
%------------------------------------------------------ ------------------------------------------------------
% 11

\begin{column}{.3\linewidth}

\begin{block}{Domain Level MRE and RMSE of Estimators \Pheight}
\begin{center}
	\begin{figure}
		\includegraphics[width=0.9\textwidth]{BoxPlotMREByDomain}
		\caption{Boxplot of Mean Relative Error on Domain Level}
	\end{figure}
		\begin{figure}
		\includegraphics[width=0.9\textwidth]{BoxPlotRMSEByDomain}
		\caption{Boxplot of RMSE on Domain Level}
	\end{figure}
\end{center}
\end{block}

\end{column}

%
%-------------------------------------------------------------------------------------------------------------
% 12

\begin{column}{.3\linewidth}


  \begin{block}{ Accuracy of inbuilt MSE estimator \Pheight}
	\begin{center}
	\begin{figure}
		\includegraphics[width=0.9\textwidth]{HistogramMSEEstimate}
		\caption{Histogram of Difference between EBP MSE estimator and the sample MSE across iterations}
	\end{figure}
\end{center}
   \end{block}
\textbf{Observations:}
\begin{itemize}
	\item Bootstrap estimator agrees quite well with sample MSE
	\item Slightly more likely to underestimate sample MSE
\end{itemize}

\end{column}

%
%------------------------------------------------------ ------------------------------------------------------
%

\end{columns}

\end{frame}


\end{document}

